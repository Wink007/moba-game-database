# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è

## –©–æ –±—É–ª–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ

### 1. –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –≥–µ—Ä–æ—ó–≤ (`sync_mlbb_stats.py`)

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑ mlbb-stats API:
  - `abilityshow` - –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∑–¥—ñ–±–Ω–æ—Å—Ç–µ–π
  - `relation` - compatibility data (assist/weak IDs)
  - `statistics` - ban/pick/win rates
- –û–Ω–æ–≤–ª—é—î —Ç—ñ–ª—å–∫–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ –¥–∞–Ω—ñ (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É—î —ñ—Å–Ω—É—é—á—ñ)
- –ü—ñ–¥—Ç—Ä–∏–º—É—î rate limiting –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É API

**–ó–∞–ø—É—Å–∫:**
```bash
railway run python3 sync_mlbb_stats.py
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫:**
```bash
# Cron —â–æ–¥–Ω—è –æ 03:00
0 3 * * * /path/to/cron_sync_mlbb_stats.sh
```

---

### 2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö –¥–∞–Ω–∏—Ö (`check_missing_data.py`)

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –°–∫–∞–Ω—É—î –≤—Å—ñ—Ö –≥–µ—Ä–æ—ó–≤ MLBB
- –í–∏—è–≤–ª—è—î —Ö—Ç–æ –º–∞—î NULL –≤ abilityshow, relation, statistics
- –ü–æ–∫–∞–∑—É—î –∑–≤—ñ—Ç

**–ó–∞–ø—É—Å–∫:**
```bash
railway run python3 check_missing_data.py
```

**–í–∏–≤—ñ–¥:**
```
============================================================
üìä –ó–≤—ñ—Ç –ø—Ä–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ –¥–∞–Ω—ñ
============================================================

ABILITYSHOW:
  ‚úÖ –í—Å—ñ –≥–µ—Ä–æ—ó –º–∞—é—Ç—å –¥–∞–Ω—ñ

RELATION:
  ‚ùå –í—ñ–¥—Å—É—Ç–Ω—ñ —É 1 –≥–µ—Ä–æ—ó–≤:
     - Franco

STATISTICS:
  ‚úÖ –í—Å—ñ –≥–µ—Ä–æ—ó –º–∞—é—Ç—å –¥–∞–Ω—ñ
============================================================
```

---

### 3. –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è Relations input –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ

**–©–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- Input –ø–æ–ª—è –¥–ª—è Hero IDs —Ç–µ–ø–µ—Ä –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å –∫–æ–º–∏ –ø—ñ–¥ —á–∞—Å –≤–≤–µ–¥–µ–Ω–Ω—è
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –æ–∫—Ä–µ–º—ñ state (`assistIdsInput`, `strongIdsInput`, `weakIdsInput`)
- onBlur –ø–∞—Ä—Å–∏—Ç—å –≤–≤–µ–¥–µ–Ω–Ω—è –≤ –º–∞—Å–∏–≤ —á–∏—Å–µ–ª
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –≥–µ—Ä–æ—è

**–§–∞–π–ª:** `/admin-panel/src/components/HeroForm.js`

---

## –Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è

### –©–æ—Ç–∏–∂–Ω–µ–≤–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö –¥–∞–Ω–∏—Ö

```bash
# 1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —è–∫—ñ –¥–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ
railway run python3 check_missing_data.py

# 2. –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏
railway run python3 sync_mlbb_stats.py

# 3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
railway run python3 check_missing_data.py
```

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó

1. **–ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ Railway:**
   - Settings ‚Üí Cron Jobs
   - –î–æ–¥–∞—Ç–∏: `0 3 * * * railway run python3 sync_mlbb_stats.py`

2. **–ù–∞ –ª–æ–∫–∞–ª—å–Ω—ñ–π –º–∞—à–∏–Ω—ñ:**
   ```bash
   crontab -e
   # –î–æ–¥–∞—Ç–∏:
   0 3 * * * /path/to/game_database/cron_sync_mlbb_stats.sh
   ```

### –û–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–¥–Ω–æ–≥–æ –≥–µ—Ä–æ—è –≤—Ä—É—á–Ω—É

```bash
railway run python3 << 'EOF'
import database as db
import json

# –û–Ω–æ–≤–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≥–µ—Ä–æ—è
conn = db.get_connection()
cursor = conn.cursor()

cursor.execute("""
    UPDATE heroes 
    SET abilityshow = %s, relation = %s
    WHERE hero_game_id = 132
""", (
    json.dumps(["60", "60", "50", "50"]),
    json.dumps({
        "assist": {"desc": "...", "target_hero_id": [17, 22, 73]},
        "weak": {"desc": "...", "target_hero_id": [2, 16, 59]}
    })
))

conn.commit()
db.release_connection(conn)
print("‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ")
EOF
```

---

## –ë–µ–∑–ø–µ–∫–∞ —ñ –æ–±–º–µ–∂–µ–Ω–Ω—è

### ‚úÖ –©–æ –±–µ–∑–ø–µ—á–Ω–æ:
- –°–∫—Ä–∏–ø—Ç –ù–ï –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É—î —ñ—Å–Ω—É—é—á—ñ –¥–∞–Ω—ñ
- –¢—ñ–ª—å–∫–∏ –∑–∞–ø–æ–≤–Ω—é—î NULL –ø–æ–ª—è
- Rate limiting 0.5s –º—ñ–∂ –∑–∞–ø–∏—Ç–∞–º–∏
- –ó–±–µ—Ä—ñ–≥–∞—î —ñ—Å–Ω—É—é—á—ñ –æ–ø–∏—Å–∏ –≤ relation

### ‚ö†Ô∏è –û–±–º–µ–∂–µ–Ω–Ω—è:
- mlbb-stats API –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–º
- –î–ª—è –¥–µ—è–∫–∏—Ö –≥–µ—Ä–æ—ó–≤ –¥–∞–Ω—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ –≤ API
- hero_game_id –≤ mlbb-stats = hero_game_id - 1 (–¥–ª—è compatibility)

---

## –õ–æ–≥–∏

–õ–æ–≥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ `logs/sync_mlbb_stats.log`:

```bash
# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ –ª–æ–≥–∏
tail -50 logs/sync_mlbb_stats.log

# –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
tail -f logs/sync_mlbb_stats.log
```

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "connection to server failed"
**–†—ñ—à–µ–Ω–Ω—è:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `railway run` –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –ë–î

### –ü—Ä–æ–±–ª–µ–º–∞: "Hero data not found in API"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å slug (name.lower().replace(" ", "-"))

### –ü—Ä–æ–±–ª–µ–º–∞: Cron –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è
**–†—ñ—à–µ–Ω–Ω—è:** 
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∞: `chmod +x cron_sync_mlbb_stats.sh`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —à–ª—è—Ö –≤ crontab: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∞–±—Å–æ–ª—é—Ç–Ω—ñ —à–ª—è—Ö–∏

---

## –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

- [ ] –î–æ–¥–∞—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫—É –¥–ª—è —ñ–Ω—à–∏—Ö —ñ–≥–æ—Ä (–Ω–µ —Ç—ñ–ª—å–∫–∏ MLBB)
- [ ] Webhook –¥–ª—è —Å–ø–æ–≤—ñ—â–µ–Ω—å –ø—Ä–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- [ ] Dashboard –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó
- [ ] Backup –¥–∞–Ω–∏—Ö –ø–µ—Ä–µ–¥ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º
- [ ] Rollback mechanism –¥–ª—è –≤—ñ–¥–∫–∞—Ç—É –∑–º—ñ–Ω

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∞—Ç–∞:** 24.12.2025  
**–í–µ—Ä—Å—ñ—è:** 1.0
